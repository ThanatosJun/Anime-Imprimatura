doctype html
html
  head
    title Generate Visitor
    script(src="https://code.jquery.com/jquery-3.6.0.min.js")
  body
    form(id="uploadForm", action="/upload", method="post", enctype="multipart/form-data")
      input(type="file", name="image")
      button(type="submit") Upload
    script.
      $(document).ready(function() {
        // When the form with id 'uploadForm' is submitted
        $('#uploadForm').on('submit', function(e) {
          e.preventDefault(); // Prevent the default form submission

          // Create a new FormData object from the form
          var formData = new FormData(this);

          // Use Ajax to submit the form data to '/upload'
          $.ajax({
            url: '/upload',
            type: 'POST',
            data: formData,
            contentType: false, // Prevent jQuery from automatically setting the content type
            processData: false, // Prevent jQuery from processing the data
            success: function(response) {
              // On successful file upload response
              var filePath = response.filePath; // Extract the filePath from the response

              // Send the filePath to another endpoint '/send-file-path'
              $.ajax({
                url: '/send-file-path',
                type: 'POST',
                data: { filePath: filePath }, // Send filePath as data
                success: function(data) {
                  console.log('File path sent to Python program.'); // Log success message
                }
              });
            },
            error: function() {
              alert('File upload failed.'); // Alert if file upload fails
            }
          });
        });
      });